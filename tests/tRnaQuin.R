#
#  Copyright (C) 2016 - Garvan Institute of Medical Research
#
#  Ted Wong, Bioinformatic Software Engineer at Garvan Institute
#

library(RUnit)
library(Anaquin)

test.RnaQuin.genes <- function()
{
    data(UserGuideData_5.4.5.1)

    data <- UserGuideData_5.4.5.1
    anaquin <- new("AnaquinData", analysis = 'Mixture',
                                      seqs = row.names(data),
                                     input = log2(data$InputConcent))

    r <- RnaQuin.genes(anaquin)
    
    ids <- c('R1_101',
             'R1_102',
             'R1_103',
             'R1_11',
             'R1_12',
             'R1_13',
             'R1_14',
             'R1_21',
             'R1_22',
             'R1_23',
             'R1_24',
             'R1_31',
             'R1_32',
             'R1_33',
             'R1_41',
             'R1_42',
             'R1_43',
             'R1_51',
             'R1_52',
             'R1_53',
             'R1_61',
             'R1_62',
             'R1_63',
             'R1_71',
             'R1_72',
             'R1_73',
             'R1_81',
             'R1_82',
             'R1_83',
             'R1_91',
             'R1_92',
             'R1_93',
             'R2_1',
             'R2_105',
             'R2_115',
             'R2_116',
             'R2_117',
             'R2_14',
             'R2_140',
             'R2_143',
             'R2_150',
             'R2_151',
             'R2_152',
             'R2_153',
             'R2_154',
             'R2_18',
             'R2_19',
             'R2_20',
             'R2_24',
             'R2_26',
             'R2_27',
             'R2_28',
             'R2_32',
             'R2_33',
             'R2_37',
             'R2_38',
             'R2_41',
             'R2_42',
             'R2_45',
             'R2_46',
             'R2_47',
             'R2_53',
             'R2_54',
             'R2_55',
             'R2_57',
             'R2_59',
             'R2_6',
             'R2_60',
             'R2_63',
             'R2_65',
             'R2_66',
             'R2_67',
             'R2_68',
             'R2_7',
             'R2_71',
             'R2_72',
             'R2_73',
             'R2_76')
        
    mix <- c(5.66421277397948,
             3.65921209292111,
             16.4942896751449,
             13.6642145646691,
             5.65921209292111,
             23.6642101998591,
             8.91706769391659,
             26.4942879963735,
             14.4942886678811,
             3.65921209292111,
             8.91706769391659,
             12.4942913539164,
             7.65921209292111,
             -8.33578630918761,
             21.6592112208919,
             23.6642101998591,
             10.4942859818409,
             19.8341383723186,
             -2.33578493393824,
             6.91707366287822,
             1.65921209292111,
             1.66421277397948,
             19.6592163737878,
             25.8341398645602,
             -0.335787226020524,
             19.6642096402682,
             11.8341377754218,
             18.7453559160269,
             7.66421277397948,
             -7.25465069250464,
             13.8341473257564,
             9.83413777542179,
             -0.0829303482612717,
             -0.0829303482612717,
             11.6642127739795,
             -2.67086192319357,
             9.83413777542179,
             36.3291410668994,
             5.91706888771089,
             -0.0829303482612717,
             16.7453509916405,
             -2.67086192319357,
             7.83413777542179,
             -5.67085390088962,
             21.8341324033447,
             25.8341398645602,
             21.6642074019023,
             7.66421277397948,
             4.49428705625359,
             16.7453509916405,
             2.49428791579213,
             -8.67085336606995,
             -8.67085336606995,
             -4.08293095948351,
             -11.6708555053466,
             -25.9592859147612,
             13.6642145646691,
             -11.6708555053466,
             -13.9592845395082,
             -14.6708576446233,
             11.6642127739795,
             -14.6708576446233,
             15.6642163553587,
             24.7453497605412,
             1.65921209292111,
             -8.67085336606995,
             13.659211458718,
             1.65921209292111,
             14.7453509916405,
             1.91706888771089,
             24.7453497605412,
             1.91706888771089,
             -1.25464895911542,
             14.7453509916405,
             -1.25464895911542,
             -17.9592868315941,
             -3.25465289863939,
             -17.6708576446233)

    all(checkEquals(ids, r$ID))
    all(checkEqualsNumeric(mix, r$Mix))    
}

test.RnaQuin.genes()